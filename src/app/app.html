<a class="sr-only focus:not-sr-only focus:absolute focus:m-4 focus:p-2 focus:bg-white focus:shadow" href="#content">{{ 'app.skip_to_content' | translate }}</a>

<ng-container *ngIf="auth.isAuthenticated(); else unauth">
<div class="min-h-screen grid grid-cols-1 lg:grid-cols-[280px_1fr]">
  <!-- Sidebar -->
  <aside class="hidden lg:block border-r border-slate-200 bg-white">
    <div class="p-4 flex items-center gap-3">
      <div class="h-10 w-10 rounded-lg bg-[hsl(var(--primary))] text-white flex items-center justify-center" aria-hidden="true">
        <span class="material-symbols-outlined">shield_person</span>
      </div>
      <div>
        <div class="font-semibold">{{ 'app.title' | translate }}</div>
        <div class="text-xs text-slate-500">v1.0</div>
      </div>
    </div>
    <nav class="px-2 py-2" aria-label="Main">
      <a *ngFor="let p of plugins" [routerLink]="'/' + p.path" routerLinkActive="active" #rla="routerLinkActive" class="sidebar-link" [attr.aria-current]="rla.isActive ? 'page' : null" [attr.aria-label]="p.i18nKey | translate">
        <span class="material-symbols-outlined" aria-hidden="true">{{ p.icon }}</span>
        <span>{{ p.i18nKey | translate }}</span>
      </a>
    </nav>
  </aside>

  <!-- Main -->
  <div class="flex min-h-screen flex-col">
    <header class="sticky top-0 z-10 border-b border-slate-200 bg-white/80 backdrop-blur">
      <div class="container-app flex h-14 items-center justify-between">
        <button class="lg:hidden btn-outline" (click)="mobileOpen = !mobileOpen" [attr.aria-expanded]="mobileOpen" aria-controls="mobile-nav">
          <span class="material-symbols-outlined">menu</span>
          <span class="sr-only">Menu</span>
        </button>
        <div class="hidden lg:block"></div>
        <div class="flex items-center gap-2">
          <select class="border rounded-md px-2 py-1 text-sm" [value]="lang()" (change)="setLang($any($event.target).value)" [attr.aria-label]="('app.language' | translate)">
            <option value="pl">PL</option>
            <option value="en">EN</option>
          </select>
          <button class="btn-outline" (click)="logout()" *ngIf="auth.user()">
            <span class="material-symbols-outlined">logout</span>
            <span class="hidden sm:inline">{{ 'app.logout' | translate }}</span>
          </button>
        </div>
      </div>
      <!-- Mobile nav -->
      <nav id="mobile-nav" class="lg:hidden" *ngIf="mobileOpen">
        <div class="container-app py-2">
          <a *ngFor="let p of plugins" [routerLink]="'/' + p.path" (click)="mobileOpen=false" class="sidebar-link" routerLinkActive="active" #rla2="routerLinkActive" [attr.aria-current]="rla2.isActive ? 'page' : null">
            <span class="material-symbols-outlined">{{ p.icon }}</span>
            <span>{{ p.i18nKey | translate }}</span>
          </a>
        </div>
      </nav>
    </header>

    <main id="content" class="flex-1">
      <router-outlet></router-outlet>
    </main>

    <footer class="border-t border-slate-200 bg-white">
      <div class="container-app h-14 flex items-center justify-between text-sm text-slate-500">
        <span>&copy; {{year}} {{ 'app.title' | translate }}</span>
        <a href="#" class="hover:underline">WCAG AA</a>
      </div>
    </footer>
  </div>
</div>
</ng-container>

<ng-template #unauth>
  <router-outlet></router-outlet>
</ng-template>
